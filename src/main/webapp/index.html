<!DOCTYPE html>
<html>
<title>Workshop</title>
<body>
		<div>
			<br>
			<form id="form">
				First name:<br> 
				<input type="text" name="firstname"><br>
				Last name:<br> 
				<input type="text" name="lastname"><br>
				Age:<br> 
				<input type="text" name="age"><br>
			</form>
			<input id="submitput" type="submit" value="Update" /> 
			<input id="submitpost" type="submit" value="Add" /> 
			<input id="submitdelete" type="submit" value="Delete" />
		</div>
		
		<table id="tabel" style="width: 100%">
                <tr>
                    <th>Firstname</th>
                    <th>Lastname</th>
                    <th>Age</th>
                </tr>
            </table>
	
	<script>
	loadPersonen();
	document.querySelector("#submitpost").addEventListener("click", addPersoon);	
	document.querySelector("#submitput").addEventListener("click", updatePersoon);	
	document.querySelector("#submitdelete").addEventListener("click", deletePersoon);	
	
	function addPersoon() {
        var formData = new FormData(document.querySelector("#form"));
        var encData = new URLSearchParams(formData.entries());

        fetch("restservices/personen", { method: 'POST', body: encData, })
            .then(response => response.json())
            .then(function (myJson) {console.log(myJson); });
        location.reload();
    }
	
	function deletePersoon() {
        var formData = new FormData(document.querySelector("#form"));
        var encData = new URLSearchParams(formData.entries());

        fetch("restservices/personen/", { method: 'DELETE', body: encData, })
            .then(response => response.json())
            .then(function (myJson) {console.log(myJson); });
        location.reload();
    }
	
	function updatePersoon() {
        var formData = new FormData(document.querySelector("#form"));
        var encData = new URLSearchParams(formData.entries());

        fetch("restservices/personen/", { method: 'PUT', body: encData, })
            .then(response => response.json())
            .then(function (myJson) {console.log(myJson); });
        location.reload();
    }
	
	function loadPersonen() {
	      fetch("restservices/personen")
	      .then(response => response.json())
	      .then(function(myJson) {
	         var tabel = document.getElementById("tabel");

	         for (const object of myJson) {
	             var rij = tabel.insertRow(1);

	             var cell1 = rij.insertCell(0);
	             var cell2 = rij.insertCell(1);
	             var cell3 = rij.insertCell(2);

	             cell1.innerHTML = object.voornaam;
	             cell2.innerHTML = object.achternaam;
	             cell3.innerHTML = object.leeftijd;

	         }
	      });
	}

</script>
	
	
</body>
</html>
